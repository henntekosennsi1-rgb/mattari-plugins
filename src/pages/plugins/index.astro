---
import Layout from '../../layouts/Layout.astro';
import Header from '../../components/Header.astro';
import Footer from '../../components/Footer.astro';

// ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãƒ‡ãƒ¼ã‚¿
const plugins = [
  // ãƒŸãƒ‹ã‚²ãƒ¼ãƒ 
  { name: '1vs1', slug: '1vs1', version: '1.0.0', icon: 'âš”ï¸', description: '1å¯¾1ã®PvPå¯¾æˆ¦ãƒ—ãƒ©ã‚°ã‚¤ãƒ³', category: 'minigame', tags: ['PvP', 'å¯¾æˆ¦'], updated: '2025-12-01' },
  { name: '2dTreasure', slug: '2dtreasure', version: '1.0.0', icon: 'ğŸ—ºï¸', description: '2Då®æ¢ã—ãƒŸãƒ‹ã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['æ¢ç´¢'], updated: '2025-11-15' },
  { name: 'BattleRoyale', slug: 'battleroyale', version: '1.2.0', icon: 'ğŸ†', description: 'ãƒãƒˆãƒ«ãƒ­ã‚¤ãƒ¤ãƒ«å½¢å¼ã®PvPã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['PvP', 'ãƒãƒˆãƒ­ãƒ¯'], updated: '2025-12-10' },
  { name: 'BlackJack2', slug: 'blackjack2', version: '2.0.0', icon: 'ğŸƒ', description: 'ãƒ–ãƒ©ãƒƒã‚¯ã‚¸ãƒ£ãƒƒã‚¯ï¼ˆãƒˆãƒ©ãƒ³ãƒ—ï¼‰', category: 'minigame', tags: ['ã‚«ãƒ¼ãƒ‰', 'ã‚®ãƒ£ãƒ³ãƒ–ãƒ«'], updated: '2025-10-20' },
  { name: 'DorokeJGame', slug: 'dorokejgame', version: '1.0.0', icon: 'ğŸƒ', description: 'ã©ã‚ã‘ã„ï¼ˆæ³¥æ£’ã¨è­¦å¯Ÿï¼‰ã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['ãƒãƒ¼ãƒ ', 'é¬¼ã”ã£ã“'], updated: '2025-11-01' },
  { name: 'FishingPointBattle', slug: 'fishingpointbattle', version: '1.0.0', icon: 'ğŸ£', description: 'é‡£ã‚Šãƒã‚¤ãƒ³ãƒˆãƒãƒˆãƒ«', category: 'minigame', tags: ['é‡£ã‚Š', 'å¯¾æˆ¦'], updated: '2025-10-15' },
  { name: 'HorseRacing2', slug: 'horseracing2', version: '2.1.0', icon: 'ğŸ‡', description: 'ç«¶é¦¬ã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['ãƒ¬ãƒ¼ã‚¹', 'ã‚®ãƒ£ãƒ³ãƒ–ãƒ«'], updated: '2025-12-05' },
  { name: 'MinecraftMOBA', slug: 'minecraftmoba', version: '1.0.0', icon: 'ğŸ°', description: 'LOLé¢¨MOBAã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['PvP', 'ãƒãƒ¼ãƒ ', 'MOBA'], updated: '2026-01-10' },
  { name: 'MonsterBall', slug: 'monsterball', version: '1.0.0', icon: 'ğŸ”´', description: 'ãƒ¢ãƒ³ã‚¹ã‚¿ãƒ¼ãƒœãƒ¼ãƒ«ã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['åé›†'], updated: '2025-09-20' },
  { name: 'NetherFortress', slug: 'netherfortress', version: '1.0.0', icon: 'ğŸ”¥', description: 'ãƒã‚¶ãƒ¼è¦å¡æ”»ç•¥ã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['PvE', 'å”åŠ›'], updated: '2025-11-25' },
  { name: 'Poker', slug: 'poker', version: '1.5.0', icon: 'â™ ï¸', description: 'ãƒãƒ¼ã‚«ãƒ¼ï¼ˆãƒ†ã‚­ã‚µã‚¹ãƒ›ãƒ¼ãƒ«ãƒ‡ãƒ ï¼‰', category: 'minigame', tags: ['ã‚«ãƒ¼ãƒ‰', 'ã‚®ãƒ£ãƒ³ãƒ–ãƒ«'], updated: '2025-12-01' },
  { name: 'QuizPlugin', slug: 'quizplugin', version: '1.0.0', icon: 'â“', description: 'ã‚¯ã‚¤ã‚ºã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['ã‚¯ã‚¤ã‚º'], updated: '2025-10-01' },
  { name: 'Slot2', slug: 'slot2', version: '2.0.0', icon: 'ğŸ°', description: 'ã‚¹ãƒ­ãƒƒãƒˆãƒã‚·ãƒ³', category: 'minigame', tags: ['ã‚®ãƒ£ãƒ³ãƒ–ãƒ«'], updated: '2025-11-10' },
  { name: 'Takarakuji', slug: 'takarakuji', version: '1.0.0', icon: 'ğŸ«', description: 'å®ãã˜', category: 'minigame', tags: ['ã‚®ãƒ£ãƒ³ãƒ–ãƒ«'], updated: '2025-10-25' },
  { name: 'Tintiro2', slug: 'tintiro2', version: '2.0.0', icon: 'ğŸ²', description: 'ãƒãƒ³ãƒãƒ­ï¼ˆã‚µã‚¤ã‚³ãƒ­è³­åšï¼‰', category: 'minigame', tags: ['ã‚®ãƒ£ãƒ³ãƒ–ãƒ«', 'ã‚µã‚¤ã‚³ãƒ­'], updated: '2025-11-05' },
  { name: 'UnoCraft2', slug: 'unocraft2', version: '2.0.0', icon: 'ğŸŸ¥', description: 'UNOã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['ã‚«ãƒ¼ãƒ‰'], updated: '2025-12-15' },
  { name: 'VillagerBall', slug: 'villagerball', version: '1.0.0', icon: 'ğŸ‘¨â€ğŸŒ¾', description: 'æ‘äººãƒœãƒ¼ãƒ«ã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['ã‚¹ãƒãƒ¼ãƒ„'], updated: '2025-09-15' },
  { name: 'Yukigassen', slug: 'yukigassen', version: '1.0.0', icon: 'â˜ƒï¸', description: 'é›ªåˆæˆ¦ã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['ãƒãƒ¼ãƒ ', 'PvP'], updated: '2025-12-20' },
  { name: 'Zinro', slug: 'zinro', version: '1.8.0', icon: 'ğŸº', description: 'äººç‹¼ã‚²ãƒ¼ãƒ ', category: 'minigame', tags: ['æ¨ç†', 'ãƒãƒ¼ãƒ '], updated: '2026-01-05' },
  // çµŒæ¸ˆ
  { name: 'EmeraldBank', slug: 'emeraldbank', version: '2.0.2', icon: 'ğŸ’', description: 'ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰é€šè²¨ã‚·ã‚¹ãƒ†ãƒ ', category: 'economy', tags: ['é€šè²¨', 'éŠ€è¡Œ'], updated: '2026-01-10' },
  { name: 'Ranking', slug: 'ranking', version: '1.2.0', icon: 'ğŸ“Š', description: 'çµ±è¨ˆãƒ©ãƒ³ã‚­ãƒ³ã‚°ã‚·ã‚¹ãƒ†ãƒ ', category: 'economy', tags: ['çµ±è¨ˆ', 'ãƒ©ãƒ³ã‚­ãƒ³ã‚°'], updated: '2025-12-01' },
  // ä¾¿åˆ©ç³»
  { name: 'AsureTimer', slug: 'asuretimer', version: '1.0.0', icon: 'â±ï¸', description: 'ã‚¢ã‚¹ãƒ¬ãƒãƒƒã‚¯ã‚¿ã‚¤ãƒ è¨ˆæ¸¬', category: 'utility', tags: ['ã‚¿ã‚¤ãƒãƒ¼', 'ã‚¢ã‚¹ãƒ¬'], updated: '2025-10-01' },
  { name: 'CaveEraser', slug: 'caveeraser', version: '1.0.0', icon: 'ğŸ•³ï¸', description: 'æ´çªŸå‰Šé™¤ãƒ»æ•´åœ°ãƒ„ãƒ¼ãƒ«', category: 'utility', tags: ['æ•´åœ°', 'ç®¡ç†è€…'], updated: '2025-09-01' },
  { name: 'Convenience', slug: 'convenience', version: '1.0.0', icon: 'ğŸ› ï¸', description: 'ä¾¿åˆ©æ©Ÿèƒ½è©°ã‚åˆã‚ã›', category: 'utility', tags: ['ä¾¿åˆ©'], updated: '2025-08-15' },
  { name: 'CustomEnchants', slug: 'customenchants', version: '1.0.0', icon: 'âœ¨', description: 'ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒãƒ£ãƒ³ãƒˆè¿½åŠ ', category: 'utility', tags: ['ã‚¨ãƒ³ãƒãƒ£ãƒ³ãƒˆ'], updated: '2025-07-01' },
  { name: 'CustomVillagerTrade', slug: 'customvillagertrade', version: '1.0.0', icon: 'ğŸª', description: 'æ‘äººå–å¼•ã‚«ã‚¹ã‚¿ãƒã‚¤ã‚º', category: 'utility', tags: ['æ‘äºº', 'å–å¼•'], updated: '2025-09-10' },
  { name: 'DigCount', slug: 'digcount', version: '1.0.0', icon: 'â›ï¸', description: 'æ¡æ˜å›æ•°ã‚«ã‚¦ãƒ³ãƒˆãƒ»ãƒ©ãƒ³ã‚­ãƒ³ã‚°', category: 'utility', tags: ['çµ±è¨ˆ', 'æ¡æ˜'], updated: '2025-10-20' },
  { name: 'EffectSidian', slug: 'effectsidian', version: '1.0.0', icon: 'ğŸ§ª', description: 'ã‚¨ãƒ¡ãƒ©ãƒ«ãƒ‰ã§ãƒãƒ•åŠ¹æœè³¼å…¥', category: 'utility', tags: ['ãƒãƒ•', 'çµŒæ¸ˆé€£æº'], updated: '2025-11-15' },
  { name: 'EnchantPlus', slug: 'enchantplus', version: '1.5.0', icon: 'ğŸ“–', description: '19ç¨®ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ³ãƒãƒ£ãƒ³ãƒˆ', category: 'utility', tags: ['ã‚¨ãƒ³ãƒãƒ£ãƒ³ãƒˆ'], updated: '2026-01-01' },
  { name: 'GlobalStorage2', slug: 'globalstorage2', version: '2.0.0', icon: 'ğŸ“¦', description: 'å…¨ãƒ—ãƒ¬ã‚¤ãƒ¤ãƒ¼å…±æœ‰å€‰åº«', category: 'utility', tags: ['å€‰åº«', 'å…±æœ‰'], updated: '2025-12-10' },
  { name: 'Seitiassist', slug: 'seitiassist', version: '1.0.0', icon: 'ğŸ”¨', description: 'æ•´åœ°ä½œæ¥­ã‚¢ã‚·ã‚¹ãƒˆãƒ„ãƒ¼ãƒ«', category: 'utility', tags: ['æ•´åœ°', 'ä¾¿åˆ©'], updated: '2025-11-20' },
  { name: 'Tintran', slug: 'tintran', version: '1.0.0', icon: 'ğŸŒ€', description: 'è»¢é€ãƒ»ãƒ†ãƒ¬ãƒãƒ¼ãƒˆã‚·ã‚¹ãƒ†ãƒ ', category: 'utility', tags: ['ç§»å‹•', 'ãƒ†ãƒ¬ãƒãƒ¼ãƒˆ'], updated: '2025-10-05' },
  // ãã®ä»–
  { name: 'BedrockReplacer', slug: 'bedrockreplacer', version: '1.0.0', icon: 'ğŸª¨', description: 'å²©ç›¤ãƒ–ãƒ­ãƒƒã‚¯ç½®æ›ãƒ„ãƒ¼ãƒ«', category: 'other', tags: ['ç®¡ç†è€…', 'æ•´åœ°'], updated: '2025-08-01' },
  { name: 'BossPlugin', slug: 'bossplugin', version: '1.0.0', icon: 'ğŸ‘¹', description: 'ã‚«ã‚¹ã‚¿ãƒ ãƒœã‚¹ãƒ¢ãƒ–è¿½åŠ ', category: 'other', tags: ['ãƒœã‚¹', 'PvE'], updated: '2025-12-01' },
  { name: 'Yukiori', slug: 'yukiori', version: '1.0.0', icon: 'â„ï¸', description: 'é›ªé™ã‚Šã‚·ã‚¹ãƒ†ãƒ ', category: 'other', tags: ['æ¼”å‡º'], updated: '2025-12-15' },
  { name: 'ZankiJP', slug: 'zankijp', version: '1.0.0', icon: 'â¤ï¸', description: 'æ®‹æ©Ÿã‚·ã‚¹ãƒ†ãƒ ', category: 'other', tags: ['ã‚²ãƒ¼ãƒ ã‚·ã‚¹ãƒ†ãƒ '], updated: '2025-09-25' },
];

const categories = [
  { id: 'all', label: 'ğŸ® ã™ã¹ã¦', count: plugins.length },
  { id: 'minigame', label: 'ğŸ² ãƒŸãƒ‹ã‚²ãƒ¼ãƒ ', count: plugins.filter(p => p.category === 'minigame').length },
  { id: 'economy', label: 'ğŸ’° çµŒæ¸ˆ', count: plugins.filter(p => p.category === 'economy').length },
  { id: 'utility', label: 'ğŸ”§ ä¾¿åˆ©ç³»', count: plugins.filter(p => p.category === 'utility').length },
  { id: 'other', label: 'ğŸ“¦ ãã®ä»–', count: plugins.filter(p => p.category === 'other').length },
];

// å…¨ã‚¿ã‚°ã‚’æŠ½å‡º
const allTags = [...new Set(plugins.flatMap(p => p.tags))].sort();
---

<Layout 
  title="ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä¸€è¦§ - MattariMinecraft" 
  description="MattariMinecraftã‚µãƒ¼ãƒãƒ¼ã§ä½¿ç”¨ã§ãã‚‹37å€‹ä»¥ä¸Šã®ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä¸€è¦§ã€‚ãƒŸãƒ‹ã‚²ãƒ¼ãƒ ã€çµŒæ¸ˆã‚·ã‚¹ãƒ†ãƒ ã€ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«ãªã©ã€‚"
>
  <Header currentPage="plugins" />

  <main class="plugins-page">
    <div class="page-header">
      <h1>ğŸ“¦ ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä¸€è¦§</h1>
      <p>MattariMinecraftã§ä½¿ãˆã‚‹{plugins.length}å€‹ã®ã‚ªãƒªã‚¸ãƒŠãƒ«ãƒ—ãƒ©ã‚°ã‚¤ãƒ³</p>
    </div>

    <div class="plugins-container">
      <!-- ã‚µã‚¤ãƒ‰ãƒãƒ¼ï¼ˆãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ï¼‰ -->
      <aside class="sidebar">
        <!-- æ¤œç´¢ãƒœãƒƒã‚¯ã‚¹ -->
        <div class="search-section">
          <label for="search-input" class="section-title">ğŸ” æ¤œç´¢</label>
          <input 
            type="text" 
            id="search-input" 
            placeholder="ãƒ—ãƒ©ã‚°ã‚¤ãƒ³åã§æ¤œç´¢..."
            autocomplete="off"
          >
        </div>

        <!-- ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
        <div class="filter-section">
          <div class="section-title">ğŸ“ ã‚«ãƒ†ã‚´ãƒª</div>
          <div class="category-list">
            {categories.map(cat => (
              <button 
                class:list={['category-btn', { active: cat.id === 'all' }]}
                data-category={cat.id}
              >
                <span>{cat.label}</span>
                <span class="count">{cat.count}</span>
              </button>
            ))}
          </div>
        </div>

        <!-- ã‚¿ã‚°ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ -->
        <div class="filter-section">
          <div class="section-title">ğŸ·ï¸ ã‚¿ã‚°</div>
          <div class="tag-list">
            {allTags.map(tag => (
              <button class="tag-btn" data-tag={tag}>{tag}</button>
            ))}
          </div>
          <button class="clear-tags-btn" id="clear-tags">ã‚¿ã‚°ã‚’ã‚¯ãƒªã‚¢</button>
        </div>

        <!-- ã‚½ãƒ¼ãƒˆ -->
        <div class="filter-section">
          <div class="section-title">ğŸ“Š ä¸¦ã³æ›¿ãˆ</div>
          <select id="sort-select">
            <option value="name-asc">åå‰ï¼ˆAâ†’Zï¼‰</option>
            <option value="name-desc">åå‰ï¼ˆZâ†’Aï¼‰</option>
            <option value="updated-desc">æ›´æ–°æ—¥ï¼ˆæ–°ã—ã„é †ï¼‰</option>
            <option value="updated-asc">æ›´æ–°æ—¥ï¼ˆå¤ã„é †ï¼‰</option>
            <option value="category">ã‚«ãƒ†ã‚´ãƒªåˆ¥</option>
          </select>
        </div>
      </aside>

      <!-- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ä¸€è¦§ -->
      <div class="plugins-main">
        <!-- çµæœãƒ˜ãƒƒãƒ€ãƒ¼ -->
        <div class="results-header">
          <span id="results-count">{plugins.length}å€‹ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³</span>
          <div class="view-toggle">
            <button class="view-btn active" data-view="grid" aria-label="ã‚°ãƒªãƒƒãƒ‰è¡¨ç¤º">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <rect x="3" y="3" width="7" height="7" rx="1"/>
                <rect x="14" y="3" width="7" height="7" rx="1"/>
                <rect x="3" y="14" width="7" height="7" rx="1"/>
                <rect x="14" y="14" width="7" height="7" rx="1"/>
              </svg>
            </button>
            <button class="view-btn" data-view="list" aria-label="ãƒªã‚¹ãƒˆè¡¨ç¤º">
              <svg width="18" height="18" viewBox="0 0 24 24" fill="currentColor">
                <rect x="3" y="4" width="18" height="4" rx="1"/>
                <rect x="3" y="10" width="18" height="4" rx="1"/>
                <rect x="3" y="16" width="18" height="4" rx="1"/>
              </svg>
            </button>
          </div>
        </div>

        <!-- ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ã‚°ãƒªãƒƒãƒ‰ -->
        <div class="plugins-grid" id="plugins-grid">
          {plugins.map(plugin => (
            <a 
              href={`/mattari-plugins/plugins/${plugin.slug}/`} 
              class="plugin-card"
              data-name={plugin.name.toLowerCase()}
              data-category={plugin.category}
              data-tags={plugin.tags.join(',')}
              data-updated={plugin.updated}
            >
              <div class="card-header">
                <span class="plugin-icon">{plugin.icon}</span>
                <span class="plugin-version">v{plugin.version}</span>
              </div>
              <h3 class="plugin-name">{plugin.name}</h3>
              <p class="plugin-desc">{plugin.description}</p>
              <div class="plugin-tags">
                {plugin.tags.slice(0, 3).map(tag => (
                  <span class="plugin-tag">{tag}</span>
                ))}
              </div>
            </a>
          ))}
        </div>

        <!-- æ¤œç´¢çµæœãªã— -->
        <div class="no-results" id="no-results" style="display: none;">
          <span class="no-results-icon">ğŸ”</span>
          <p>æ¡ä»¶ã«ä¸€è‡´ã™ã‚‹ãƒ—ãƒ©ã‚°ã‚¤ãƒ³ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“</p>
          <button class="reset-btn" id="reset-filters">ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ã‚’ãƒªã‚»ãƒƒãƒˆ</button>
        </div>
      </div>
    </div>
  </main>

  <Footer />
</Layout>

<script>
  const searchInput = document.getElementById('search-input') as HTMLInputElement;
  const categoryBtns = document.querySelectorAll('.category-btn');
  const tagBtns = document.querySelectorAll('.tag-btn');
  const clearTagsBtn = document.getElementById('clear-tags');
  const sortSelect = document.getElementById('sort-select') as HTMLSelectElement;
  const pluginsGrid = document.getElementById('plugins-grid');
  const pluginCards = document.querySelectorAll('.plugin-card');
  const resultsCount = document.getElementById('results-count');
  const noResults = document.getElementById('no-results');
  const resetFiltersBtn = document.getElementById('reset-filters');
  const viewBtns = document.querySelectorAll('.view-btn');

  let currentCategory = 'all';
  let selectedTags: string[] = [];
  let searchQuery = '';
  let currentSort = 'name-asc';

  function applyFilters() {
    let visibleCount = 0;
    pluginCards.forEach(card => {
      const name = card.getAttribute('data-name') || '';
      const category = card.getAttribute('data-category') || '';
      const tags = (card.getAttribute('data-tags') || '').split(',');
      const categoryMatch = currentCategory === 'all' || category === currentCategory;
      const tagsMatch = selectedTags.length === 0 || selectedTags.some(t => tags.includes(t));
      const searchMatch = searchQuery === '' || name.includes(searchQuery.toLowerCase());
      if (categoryMatch && tagsMatch && searchMatch) {
        (card as HTMLElement).style.display = '';
        visibleCount++;
      } else {
        (card as HTMLElement).style.display = 'none';
      }
    });
    if (resultsCount) resultsCount.textContent = `${visibleCount}å€‹ã®ãƒ—ãƒ©ã‚°ã‚¤ãƒ³`;
    if (noResults && pluginsGrid) {
      if (visibleCount === 0) {
        noResults.style.display = 'flex';
        pluginsGrid.style.display = 'none';
      } else {
        noResults.style.display = 'none';
        pluginsGrid.style.display = '';
      }
    }
  }

  function applySort() {
    const cards = Array.from(pluginCards);
    cards.sort((a, b) => {
      const nameA = a.getAttribute('data-name') || '';
      const nameB = b.getAttribute('data-name') || '';
      const updatedA = a.getAttribute('data-updated') || '';
      const updatedB = b.getAttribute('data-updated') || '';
      const categoryA = a.getAttribute('data-category') || '';
      const categoryB = b.getAttribute('data-category') || '';
      switch (currentSort) {
        case 'name-asc': return nameA.localeCompare(nameB);
        case 'name-desc': return nameB.localeCompare(nameA);
        case 'updated-desc': return updatedB.localeCompare(updatedA);
        case 'updated-asc': return updatedA.localeCompare(updatedB);
        case 'category': return categoryA.localeCompare(categoryB) || nameA.localeCompare(nameB);
        default: return 0;
      }
    });
    cards.forEach(card => pluginsGrid?.appendChild(card));
  }

  searchInput?.addEventListener('input', (e) => {
    searchQuery = (e.target as HTMLInputElement).value;
    applyFilters();
  });

  categoryBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      categoryBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      currentCategory = btn.getAttribute('data-category') || 'all';
      applyFilters();
    });
  });

  tagBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      const tag = btn.getAttribute('data-tag') || '';
      btn.classList.toggle('active');
      if (selectedTags.includes(tag)) {
        selectedTags = selectedTags.filter(t => t !== tag);
      } else {
        selectedTags.push(tag);
      }
      applyFilters();
    });
  });

  clearTagsBtn?.addEventListener('click', () => {
    selectedTags = [];
    tagBtns.forEach(btn => btn.classList.remove('active'));
    applyFilters();
  });

  sortSelect?.addEventListener('change', (e) => {
    currentSort = (e.target as HTMLSelectElement).value;
    applySort();
  });

  resetFiltersBtn?.addEventListener('click', () => {
    searchQuery = '';
    currentCategory = 'all';
    selectedTags = [];
    if (searchInput) searchInput.value = '';
    categoryBtns.forEach(b => b.classList.remove('active'));
    categoryBtns[0]?.classList.add('active');
    tagBtns.forEach(btn => btn.classList.remove('active'));
    applyFilters();
  });

  viewBtns.forEach(btn => {
    btn.addEventListener('click', () => {
      viewBtns.forEach(b => b.classList.remove('active'));
      btn.classList.add('active');
      const view = btn.getAttribute('data-view');
      pluginsGrid?.classList.toggle('list-view', view === 'list');
    });
  });
</script>

<style>
  .plugins-page { max-width: 1400px; margin: 0 auto; padding: 0 20px 60px; }
  .page-header { text-align: center; padding: 50px 20px 40px; color: white; }
  .page-header h1 { font-size: 36px; margin-bottom: 10px; }
  .page-header p { font-size: 16px; opacity: 0.9; }
  .plugins-container { display: grid; grid-template-columns: 280px 1fr; gap: 30px; }
  .sidebar { background: white; border-radius: 15px; padding: 25px; height: fit-content; position: sticky; top: 100px; }
  .section-title { font-size: 14px; font-weight: 600; color: #333; margin-bottom: 12px; }
  .search-section { margin-bottom: 25px; }
  .search-section input { width: 100%; padding: 12px 15px; border: 2px solid #e9ecef; border-radius: 10px; font-size: 14px; transition: all 0.3s; }
  .search-section input:focus { outline: none; border-color: #667eea; box-shadow: 0 0 0 3px rgba(102,126,234,0.1); }
  .filter-section { margin-bottom: 25px; padding-bottom: 20px; border-bottom: 1px solid #eee; }
  .filter-section:last-child { border-bottom: none; margin-bottom: 0; padding-bottom: 0; }
  .category-list { display: flex; flex-direction: column; gap: 6px; }
  .category-btn { display: flex; justify-content: space-between; align-items: center; padding: 10px 14px; background: #f8f9fa; border: none; border-radius: 8px; cursor: pointer; font-size: 13px; color: #555; transition: all 0.3s; text-align: left; }
  .category-btn:hover { background: #e9ecef; }
  .category-btn.active { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; }
  .category-btn .count { background: rgba(0,0,0,0.1); padding: 2px 8px; border-radius: 10px; font-size: 11px; }
  .category-btn.active .count { background: rgba(255,255,255,0.2); }
  .tag-list { display: flex; flex-wrap: wrap; gap: 6px; margin-bottom: 12px; }
  .tag-btn { padding: 6px 12px; background: #f1f3f5; border: none; border-radius: 15px; font-size: 12px; color: #555; cursor: pointer; transition: all 0.3s; }
  .tag-btn:hover { background: #e9ecef; }
  .tag-btn.active { background: #667eea; color: white; }
  .clear-tags-btn { width: 100%; padding: 8px; background: none; border: 1px dashed #ccc; border-radius: 8px; font-size: 12px; color: #888; cursor: pointer; transition: all 0.3s; }
  .clear-tags-btn:hover { border-color: #667eea; color: #667eea; }
  .filter-section select { width: 100%; padding: 10px 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 13px; cursor: pointer; }
  .filter-section select:focus { outline: none; border-color: #667eea; }
  .plugins-main { background: white; border-radius: 15px; padding: 25px; }
  .results-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
  #results-count { font-size: 14px; color: #666; }
  .view-toggle { display: flex; gap: 5px; }
  .view-btn { padding: 8px; background: #f1f3f5; border: none; border-radius: 8px; cursor: pointer; color: #666; transition: all 0.3s; }
  .view-btn:hover { background: #e9ecef; }
  .view-btn.active { background: #667eea; color: white; }
  .plugins-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 20px; }
  .plugin-card { background: #f8f9fa; border-radius: 12px; padding: 20px; text-decoration: none; transition: all 0.3s; border: 2px solid transparent; }
  .plugin-card:hover { transform: translateY(-5px); border-color: #667eea; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
  .card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
  .plugin-icon { font-size: 36px; }
  .plugin-version { font-size: 11px; color: #888; background: #e9ecef; padding: 3px 8px; border-radius: 10px; }
  .plugin-name { font-size: 16px; font-weight: 600; color: #333; margin-bottom: 8px; }
  .plugin-desc { font-size: 13px; color: #666; line-height: 1.5; margin-bottom: 12px; }
  .plugin-tags { display: flex; flex-wrap: wrap; gap: 5px; }
  .plugin-tag { font-size: 11px; padding: 3px 8px; background: #e9ecef; border-radius: 10px; color: #666; }
  .plugins-grid.list-view { grid-template-columns: 1fr; }
  .plugins-grid.list-view .plugin-card { display: grid; grid-template-columns: auto 1fr auto; align-items: center; gap: 20px; padding: 15px 20px; }
  .plugins-grid.list-view .card-header { margin-bottom: 0; flex-direction: column; gap: 5px; }
  .plugins-grid.list-view .plugin-desc { margin-bottom: 0; }
  .plugins-grid.list-view .plugin-tags { justify-content: flex-end; }
  .no-results { display: flex; flex-direction: column; align-items: center; padding: 60px 20px; text-align: center; }
  .no-results-icon { font-size: 60px; margin-bottom: 20px; opacity: 0.5; }
  .no-results p { color: #666; margin-bottom: 20px; }
  .reset-btn { padding: 12px 25px; background: #667eea; color: white; border: none; border-radius: 25px; font-size: 14px; cursor: pointer; transition: all 0.3s; }
  .reset-btn:hover { background: #764ba2; }
  @media (max-width: 900px) { .plugins-container { grid-template-columns: 1fr; } .sidebar { position: static; } }
  @media (max-width: 600px) { .plugins-grid { grid-template-columns: 1fr; } .page-header h1 { font-size: 28px; } }
</style>
